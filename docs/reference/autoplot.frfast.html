<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Useful for drawing the estimated regression function, 
first and second derivative (for each factor's level) using ggplot2 graphics.
 Additionally, with the 
diffwith argument it is possible to draw the differences between
 two factor's levels."><title>Visualization of frfast objects with ggplot2 graphics — autoplot.frfast • npregfast</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualization of frfast objects with ggplot2 graphics — autoplot.frfast"><meta property="og:description" content="Useful for drawing the estimated regression function, 
first and second derivative (for each factor's level) using ggplot2 graphics.
 Additionally, with the 
diffwith argument it is possible to draw the differences between
 two factor's levels."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">npregfast</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/sestelo/npregfast/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Visualization of <code>frfast</code> objects with ggplot2 graphics</h1>
      <small class="dont-index">Source: <a href="http://github.com/sestelo/npregfast/blob/HEAD/R/autoplot.frfast.R" class="external-link"><code>R/autoplot.frfast.R</code></a></small>
      <div class="d-none name"><code>autoplot.frfast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Useful for drawing the estimated regression function, 
first and second derivative (for each factor's level) using ggplot2 graphics.
 Additionally, with the 
<code>diffwith</code> argument it is possible to draw the differences between
 two factor's levels.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for frfast</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="va">model</span>,</span>
<span>  fac <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  der <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  diffwith <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  points <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">name</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>  ylab <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">name</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  CIcol <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  CIlinecol <span class="op">=</span> <span class="st">"transparent"</span>,</span>
<span>  pcol <span class="op">=</span> <span class="st">"grey80"</span>,</span>
<span>  abline <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ablinecol <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  CIlty <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  CIlwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">1.4</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><code>frfast</code> object.</p></dd>


<dt>fac</dt>
<dd><p>Factor's level to be taken into account
in the plot. By default is <code>NULL</code>.</p></dd>


<dt>der</dt>
<dd><p>Number which determines any inference process. 
By default <code>der</code> is <code>0</code>. If this term is <code>0</code>, the plot 
shows the initial estimate. If it is <code>1</code> or <code>2</code>,
it is designed for the first or second derivative, respectively.</p></dd>


<dt>diffwith</dt>
<dd><p>Factor's level used for drawing the differences respect to the 
level specified in the <code>fac</code> argument.  By default, <code>NULL</code>. 
The differences are computed for the r-th derivative specified 
in the <code>der</code> argument.</p></dd>


<dt>points</dt>
<dd><p>Draw the original data into the plot. By default it is
<code>TRUE</code>.</p></dd>


<dt>xlab</dt>
<dd><p>A title for the <code>x</code> axis.</p></dd>


<dt>ylab</dt>
<dd><p>A title for the <code>y</code> axis.</p></dd>


<dt>ylim</dt>
<dd><p>The <code>y</code> limits of the plot.</p></dd>


<dt>main</dt>
<dd><p>An overall title for the plot.</p></dd>


<dt>col</dt>
<dd><p>A specification for the default plotting color.</p></dd>


<dt>CIcol</dt>
<dd><p>A specification for the default confidence intervals
plotting color (for the fill).</p></dd>


<dt>CIlinecol</dt>
<dd><p>A specification for the default confidence intervals
plotting color (for the edge).</p></dd>


<dt>pcol</dt>
<dd><p>A specification for the points color.</p></dd>


<dt>abline</dt>
<dd><p>Draw an horizontal line into the plot of the second derivative 
of the model.</p></dd>


<dt>ablinecol</dt>
<dd><p>The color to be used for <code>abline</code>.</p></dd>


<dt>lty</dt>
<dd><p>The line type. Line types can either be specified as an integer
(0 = blank, 1 = solid (default), 2 = dashed, 3 = dotted, 4 = dotdash, 
5 = longdash, 6 = twodash).  See details in <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt>CIlty</dt>
<dd><p>The line type for confidence intervals. Line types can either 
be specified as an integer (0 = blank, 1 = solid (default), 2 = dashed,
3 = dotted, 4 = dotdash, 5 = longdash, 6 = twodash).</p></dd>


<dt>lwd</dt>
<dd><p>The line width, a positive number, defaulting to 1.
See details in <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt>CIlwd</dt>
<dd><p>The line width for confidence intervals, a positive number, 
defaulting to 1.</p></dd>


<dt>cex</dt>
<dd><p>A numerical value giving the amount by which plotting symbols
should be magnified relative to the default. See details in <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt>alpha</dt>
<dd><p>Alpha transparency for overlapping elements expressed 
as a fraction between 0 (complete transparency) and 1 (complete opacity).</p></dd>


<dt>...</dt>
<dd><p>Other options.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A ggplot object, so you can use common features from 
ggplot2 package to manipulate the plot.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">npregfast</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">barnacle</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Nonparametric regression without interactions</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="frfast.html">frfast</a></span><span class="op">(</span><span class="va">DW</span> <span class="op">~</span> <span class="va">RC</span>, data <span class="op">=</span> <span class="va">barnacle</span>, nboot <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.frfast-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fit</span>, points <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Title"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.frfast-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fit</span>, der <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.frfast-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">#autoplot(fit, der = 1, col = "red", CIcol = "blue")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Nonparametric regression with interactions</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="frfast.html">frfast</a></span><span class="op">(</span><span class="va">DW</span> <span class="op">~</span> <span class="va">RC</span> <span class="op">:</span> <span class="cn">F</span>, data <span class="op">=</span> <span class="va">barnacle</span>, nboot <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fit2</span>, fac <span class="op">=</span> <span class="st">"barca"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.frfast-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># autoplot(fit2, der = 1, fac = "lens")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Visualization of the differences between two factor's levels</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fit2</span>, fac <span class="op">=</span> <span class="st">"barca"</span>, diffwith <span class="op">=</span> <span class="st">"lens"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.frfast-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># autoplot(fit2, der = 1, fac = "barca", diffwith = "lens")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Plotting in the same graphics device</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"gridExtra"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For plotting two derivatives in the same graphic windows</span></span></span>
<span class="r-in"><span><span class="va">ders</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fit</span>, der <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>grobs <span class="op">=</span> <span class="va">ders</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For plotting two levels in the same graphic windows</span></span></span>
<span class="r-in"><span><span class="va">facs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"barca"</span>, <span class="st">"lens"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fit2</span>, der <span class="op">=</span> <span class="fl">0</span>, fac <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>grobs <span class="op">=</span> <span class="va">facs</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Marta Sestelo, Nora M. Villanueva, Javier Roca-Pardinas.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

