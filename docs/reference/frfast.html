<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function is used to fit nonparametric models by
using local polynomial kernel smoothers or splines. These models can 
include or not  
factor-by-curve interactions. Additionally, a parametric 
model (allometric model) can be estimated (or not)."><title>Fitting nonparametric models — frfast • npregfast</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting nonparametric models — frfast"><meta property="og:description" content="This function is used to fit nonparametric models by
using local polynomial kernel smoothers or splines. These models can 
include or not  
factor-by-curve interactions. Additionally, a parametric 
model (allometric model) can be estimated (or not)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">npregfast</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/sestelo/npregfast/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fitting nonparametric models</h1>
      <small class="dont-index">Source: <a href="http://github.com/sestelo/npregfast/blob/HEAD/R/frfast.R" class="external-link"><code>R/frfast.R</code></a></small>
      <div class="d-none name"><code>frfast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is used to fit nonparametric models by
using local polynomial kernel smoothers or splines. These models can 
include or not  
factor-by-curve interactions. Additionally, a parametric 
model (allometric model) can be estimated (or not).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">frfast</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  na.action <span class="op">=</span> <span class="st">"na.omit"</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"np"</span>,</span>
<span>  smooth <span class="op">=</span> <span class="st">"kernel"</span>,</span>
<span>  h0 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  h <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  nh <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  kernel <span class="op">=</span> <span class="st">"epanech"</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  kbin <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  nboot <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  rankl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ranku <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ncores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>An object of class <code>formula</code>: a sympbolic 
description of the model to be fitted. The details of model 
specification are given under 'Details'.</p></dd>


<dt>data</dt>
<dd><p>An optional data frame, matrix or list required by 
the formula. If not found in data, the variables are taken from 
<code>environment(formula)</code>, typically the environment from which
 <code>frfast</code> is called.</p></dd>


<dt>na.action</dt>
<dd><p>A function which indicates what should happen when the 
data contain 'NA's. The default is 'na.omit'.</p></dd>


<dt>model</dt>
<dd><p>Type model used: <code>model = "np"</code> for a nonparametric
regression model, 
<code>model = "allo"</code>  for an allometric model. See details.</p></dd>


<dt>smooth</dt>
<dd><p>Type smoother used: <code>smooth = "kernel"</code> for local polynomial
kernel smoothers and <code>smooth = "splines"</code> for splines using the 
<code>mgcv</code> package.</p></dd>


<dt>h0</dt>
<dd><p>The kernel bandwidth smoothing parameter for the global effect (see
references for more details at the estimation). Large values of the bandwidth lead
to smoothed estimates; smaller values of the bandwidth lead lo undersmoothed estimates. 
By default, cross validation is used to obtain the bandwidth.</p></dd>


<dt>h</dt>
<dd><p>The kernel bandwidth smoothing parameter for the partial effects.</p></dd>


<dt>nh</dt>
<dd><p>Integer number of equally-spaced bandwidth in which the
<code>h</code> is discretised, to speed up computation in the kernel-based regression.</p></dd>


<dt>weights</dt>
<dd><p>Prior weights on the data.</p></dd>


<dt>kernel</dt>
<dd><p>A character string specifying the desired kernel. 
Defaults to <code>kernel = "epanech"</code>, where the Epanechnikov
density function kernel will be used. Also, several types of kernel functons 
can be used:  triangular and Gaussian density function, 
with <code>"triang"</code> and <code>"gaussian"</code> term, respectively.</p></dd>


<dt>p</dt>
<dd><p>Polynomial degree to be used in the kernel-based regression. Its 
value must be the value of
derivative + 1. The default value is 3, returning 
the estimation, first and second derivative.</p></dd>


<dt>kbin</dt>
<dd><p>Number of binning nodes over which the function 
is to be estimated.</p></dd>


<dt>nboot</dt>
<dd><p>Number of bootstrap repeats. Defaults to 500 bootstrap repeats. 
The wild bootstrap is used when <code>model = "np"</code> and the simple bootstrap 
when <code>model = "allo"</code>.</p></dd>


<dt>rankl</dt>
<dd><p>Number or vector specifying the minimum value for the
interval at which to search the <code>x</code> value which maximizes the
estimate, first or second derivative  (for each level). The default
is the minimum data value.</p></dd>


<dt>ranku</dt>
<dd><p>Number or vector specifying the maximum value for the
interval at which to search the <code>x</code> value which maximizes the
estimate, first or second derivative  (for each level). The default
is the maximum data value.</p></dd>


<dt>seed</dt>
<dd><p>Seed to be used in the bootstrap procedure.</p></dd>


<dt>cluster</dt>
<dd><p>A logical value. If  <code>TRUE</code> (default), the
bootstrap procedure is  parallelized (only for <code>smooth = "splines"</code>).
 Note that there are cases 
(e.g., a low number of bootstrap repetitions) that R will gain in
performance through serial computation. R takes time to distribute tasks
across the processors also it will need time for binding them all together
later on. Therefore, if the time for distributing and gathering pieces
together is greater than the time need for single-thread computing, it does
not worth parallelize.</p></dd>


<dt>ncores</dt>
<dd><p>An integer value specifying the number of cores to be used
in the parallelized procedure. If <code>NULL</code> (default), the number of cores 
to be used is equal to the number of cores of the machine - 1.</p></dd>


<dt>...</dt>
<dd><p>Other options.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object is returned with the following elements:</p>
<dl><dt>x</dt>
<dd><p>Vector of values of the grid points at which model is to 
be estimate.</p></dd>

<dt>p</dt>
<dd><p>Matrix of values of the grid points at which to compute the 
estimate, their first and second derivative.</p></dd>

<dt>pl</dt>
<dd><p>Lower values of  95% confidence interval for the estimate, 
their first and second derivative.</p></dd>

<dt>pu</dt>
<dd><p>Upper values of  95% confidence interval for the estimate, 
their first and second derivative.</p></dd>

<dt>diff</dt>
<dd><p>Differences between the estimation values of a couple of 
levels (i. e. level 2 - level 1). The same procedure for their first
and second derivative.</p></dd>

<dt>diffl</dt>
<dd><p>Lower values of 95% confidence interval for the differences 
between the estimation values of a couple of levels. It is performed 
for their first and second derivative.</p></dd>

<dt>diffu</dt>
<dd><p>Upper values of 95% confidence interval for the differences 
between the estimation values of a couple of levels. It is performed for 
their first and second derivative.</p></dd>

<dt>nboot</dt>
<dd><p>Number of bootstrap repeats.</p></dd>

<dt>n</dt>
<dd><p>Sample size.</p></dd>

<dt>dp</dt>
<dd><p>Degree of polynomial to be used.</p></dd>

<dt>h0</dt>
<dd><p>The kernel bandwidth smoothing parameter for the global effect.</p></dd>

<dt>h</dt>
<dd><p>The kernel bandwidth smoothing parameter for the partial effects.</p></dd>

<dt>fmod</dt>
<dd><p>Factor's level for each data.</p></dd>

<dt>xdata</dt>
<dd><p>Original x values.</p></dd>

<dt>ydata</dt>
<dd><p>Original y values.</p></dd>

<dt>w</dt>
<dd><p>Weights on the data.</p></dd>

<dt>kbin</dt>
<dd><p>Number of binning nodes over which the function is to 
be estimated.</p></dd>

<dt>nf</dt>
<dd><p>Number of levels.</p></dd>

<dt>max</dt>
<dd><p>Value of covariate <code>x</code> which maximizes the  estimate, 
first or second derivative.</p></dd>

<dt>maxu</dt>
<dd><p>Upper value of 95% confidence interval for the 
value <code>max</code>.</p></dd>

<dt>maxl</dt>
<dd><p>Lower value of 95% confidence interval for the 
value <code>max</code>.</p></dd>

<dt>diffmax</dt>
<dd><p>Differences between the estimation of <code>max</code> for a 
couple of levels (i. e. level 2 - level 1). The same procedure for their 
first and second derivative.</p></dd>

<dt>diffmaxu</dt>
<dd><p>Upper value of 95% confidence interval for the value 
<code>diffmax</code>.</p></dd>

<dt>diffmaxl</dt>
<dd><p>Lower value of 95% confidence interval for the value 
<code>diffmax</code>.</p></dd>

<dt>repboot</dt>
<dd><p>Matrix of values of the grid points at which to compute 
the estimate, their first and second derivative for each bootstrap repeat.</p></dd>

<dt>rankl</dt>
<dd><p>Maximum value for the interval at which to search the 
<code>x</code> value which maximizes the estimate, first or second derivative  
(for each level). The default is the maximum data value.</p></dd>

<dt>ranku</dt>
<dd><p>Minimum value for the interval at which to search the 
<code>x</code> value which maximizes the estimate, first or second derivative  
(for each level). The default is the minimum data value.</p></dd>

<dt>nmodel</dt>
<dd><p>Type model used: <code>nmodel = 1</code> the nonparametric model, 
<code>nmodel = 2</code> the allometric model.</p></dd>

<dt>label</dt>
<dd><p>Labels of the variables in the model.</p></dd>

<dt>numlabel</dt>
<dd><p>Number of labels.</p></dd>

<dt>kernel</dt>
<dd><p>A character specifying the derised kernel.</p></dd>

<dt>a</dt>
<dd><p>Estimated coefficient in the case of fitting an allometric model.</p></dd>

<dt>al</dt>
<dd><p>Lower value of 95% confidence interval for the value of <code>a</code>.</p></dd>

<dt>au</dt>
<dd><p>Upper value of 95% confidence interval for the value of <code>a</code>.</p></dd>

<dt>b</dt>
<dd><p>Estimated coefficient in the case of fitting an allometric model.</p></dd>

<dt>bl</dt>
<dd><p>Lower value of 95% confidence interval for the value of <code>b</code>.</p></dd>

<dt>bu</dt>
<dd><p>Upper value of 95% confidence interval for the value of <code>b</code>.</p></dd>

<dt>name</dt>
<dd><p>Name of the variables in the model.</p></dd>

<dt>formula</dt>
<dd><p>A sympbolic description of the model to be fitted.</p></dd>

<dt>nh</dt>
<dd><p>Integer number of equally-spaced bandwidth on which the
<code>h</code> is discretised.</p></dd>

<dt>r2</dt>
<dd><p>Coefficient of determination (in the case of the allometric model).</p></dd>

<dt>smooth</dt>
<dd><p>Type smoother used.</p></dd>

<dt>cluster</dt>
<dd><p>Is the procedure parallelized? (for splines smoothers).</p></dd>

<dt>ncores</dt>
<dd><p>Number of cores used in the parallelized procedure? (for splines smoothers).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The models fitted by <code>frfast</code> function are specified 
in a compact symbolic form. The ~ operator is basic in the formation 
of such models. An expression of the form <code>y ~ model</code>  is interpreted as 
a specification that the response <code>y</code> is modelled by a predictor 
specified symbolically by <code>model</code>. The possible terms consist of a 
variable name or a variable name and a factor name separated by : operator. 
Such a term is interpreted as the interaction of the continuous variable and 
the factor. However, if <code>smooth = "splines"</code>, the formula is based on the function
formula.gam of the mgcv package.</p>
<p>According with the <code>model</code> argument, if <code>model = "np"</code> the 
estimated regression model will be of the type</p>
<p>$$Y = m(X) + e$$
being \(m\) an smooth and unknown function and \(e\)
the regression error with zero mean. If <code>model = "allo"</code>, users could estimate
the classical allometric model (Huxley, 1924) with a regression curve</p>
<p>$$m(X) = a X^b$$
being \(a\) and \(b\) the parameters of the model.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Huxley, J. S. (1924). Constant differential growth-ratios and their 
significance. Nature, 114:895--896.</p>
<p>Sestelo, M. (2013). Development and computational implementation of 
estimation and inference methods in flexible regression models. 
Applications in Biology, Engineering and Environment. PhD Thesis, Department
of Statistics and O.R. University of Vigo.</p>
<p>Sestelo, M., Villanueva, N.M., Meira-Machado, L., Roca-Pardinas, J. (2017). 
npregfast: An R Package for Nonparametric Estimation and Inference in Life 
Sciences. Journal of Statistical Software, 82(12), 1-27.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Marta Sestelo, Nora M. Villanueva and Javier Roca-Pardinas.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">npregfast</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">barnacle</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Nonparametric regression without interactions</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">frfast</span><span class="op">(</span><span class="va">DW</span> <span class="op">~</span> <span class="va">RC</span>, data <span class="op">=</span> <span class="va">barnacle</span>, nboot <span class="op">=</span> <span class="fl">100</span>, smooth <span class="op">=</span> <span class="st">"kernel"</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">fit</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> frfast(formula = DW ~ RC, data = barnacle, smooth = "kernel", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nboot = 100)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ********************************************* </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nonparametric Model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ********************************************* </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Observations: 2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Bootstrap Repeats: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type of Nonparametric Smoother: kernel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bandwidth: 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Function: Epanechnikov</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> frfast(formula = DW ~ RC, data = barnacle, smooth = "kernel", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nboot = 100)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ********************************************* </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nonparametric Model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ********************************************* </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type of nonparametric smoother:  kernel </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel: Epanechnikov </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bandwidth: 0.28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polynomial degree: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of bootstrap repeats: 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of binning nodes 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The number of data is:  2000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summaries for the response variable: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0000  0.1300  0.4200  0.5705  0.8900  2.5800 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using  splines</span></span></span>
<span class="r-in"><span><span class="co">#fit &lt;- frfast(DW ~ s(RC), data = barnacle, nboot = 100, </span></span></span>
<span class="r-in"><span><span class="co">#smooth = "splines", cluster = TRUE, ncores = 2) </span></span></span>
<span class="r-in"><span><span class="co">#fit</span></span></span>
<span class="r-in"><span><span class="co">#summary(fit)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change the number of binning nodes and bootstrap replicates</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">frfast</span><span class="op">(</span><span class="va">DW</span> <span class="op">~</span> <span class="va">RC</span>, data <span class="op">=</span> <span class="va">barnacle</span>, kbin <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>               nboot <span class="op">=</span> <span class="fl">100</span>, smooth <span class="op">=</span> <span class="st">"kernel"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Nonparametric regression with interactions</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">frfast</span><span class="op">(</span><span class="va">DW</span> <span class="op">~</span> <span class="va">RC</span> <span class="op">:</span> <span class="cn">F</span>, data <span class="op">=</span> <span class="va">barnacle</span>, nboot <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> frfast(formula = DW ~ RC:F, data = barnacle, nboot = 100)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ********************************************* </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nonparametric Model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ********************************************* </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Observations: 2000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Factors: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Bootstrap Repeats: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type of Nonparametric Smoother: kernel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bandwidth: 0.28 0.52 1.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel Function: Epanechnikov</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> frfast(formula = DW ~ RC:F, data = barnacle, nboot = 100)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ********************************************* </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Nonparametric Model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ********************************************* </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Type of nonparametric smoother:  kernel </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kernel: Epanechnikov </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bandwidth: 0.28 0.52 1.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Polynomial degree: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of bootstrap repeats: 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of binning nodes 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The number of data is:  2000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The factor's levels are:  barca lens </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The number of data for the level barca is: 1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The number of data for the level lens is: 1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summaries for the response variable (for each level):  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level barca : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0000  0.1300  0.4100  0.5437  0.8425  2.2500 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Level lens : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0000  0.1400  0.4350  0.5974  0.9500  2.5800 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># using  splines</span></span></span>
<span class="r-in"><span><span class="co">#fit2 &lt;- frfast(DW ~ s(RC, by = F), data = barnacle,</span></span></span>
<span class="r-in"><span><span class="co">#               nboot = 100, smooth = "splines", cluster = TRUE, ncores = 2)</span></span></span>
<span class="r-in"><span><span class="co">#fit2</span></span></span>
<span class="r-in"><span><span class="co">#summary(fit2)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Allometric model</span></span></span>
<span class="r-in"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu">frfast</span><span class="op">(</span><span class="va">DW</span> <span class="op">~</span> <span class="va">RC</span>, data <span class="op">=</span> <span class="va">barnacle</span>, model <span class="op">=</span> <span class="st">"allo"</span>, nboot <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> frfast(formula = DW ~ RC, data = barnacle, model = "allo", nboot = 100)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ********************************************* </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Allometric Model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ********************************************* </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               2.5 %   97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a 0.000269 0.000247 0.000286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b 2.908623 2.883949 2.940579</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjusted R-squared:  0.9446261 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ********************************************* </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of bootstrap repeats: 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of binning nodes 100 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The number of data is:  2000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The factor's levels are:  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0000  0.1300  0.4200  0.5705  0.8900  2.5800 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit4 &lt;- frfast(DW ~ RC : F, data = barnacle, model = "allo", nboot = 100)</span></span></span>
<span class="r-in"><span><span class="co"># summary(fit4)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Marta Sestelo, Nora M. Villanueva, Javier Roca-Pardinas.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

